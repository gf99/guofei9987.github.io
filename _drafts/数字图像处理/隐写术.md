
## 简介
隐写分析：分析可以载体是否被隐写。  
- 属于模式识别或机器学习分类问题。
- 用机器学习技术，察觉特性很小的偏差
- 隐写算法在嵌入秘密数据时，必定修改原数据。载体的某些统计特征必然变化。
- 通用隐写分析针对多种隐写术。专用隐写分析针对某个隐写术。


估计秘密信息长度、破译秘密信息，属于量化分析和解密范畴。

隐写分析方法
- 视觉隐写分析。（Visual steganalysis）
- 结构隐写分析（Structural steganalysis）
- 统计隐写分析（Statistical steganalysis）
- 学习隐写分析（Learning steganalysis）

视觉隐写分析：  
某个隐写术利用了人类视觉的不可感知性。对某个图做二值化，发达有大量噪点，判断用了隐写术。  

![隐写术1](/pictures_for_blog/digital_image_processing/steganography.png)

(左边是原图二值化，右边是打上隐写的图二值化，显然右边隐写了信息)  

结构隐写分析：
- 任何隐写工具都会引入某种特征。
- 早起某种文本隐写术，利用html的特点
- 文本，调整文本颜色、大小、位置
- 链接：不用下划线，且鼠标指针经过链接时不变化
- 注释：html注释

### 攻击
- 被动攻击：接受载体，分析载体
- 主动攻击：截取载体，处理载体（例如压缩图片，要保证人感知不到变化），继续传输载体。

### 隐写分析方法

- 学习：用大量的隐写后的文件，未隐写的文件，做一个二分类模型。
- 模式识别：相似样本在模式空间接近。SVM
- 参数统计建模

## 空域隐写分析

### LSB算法
LSB（最低有效位，Least Significant Bit）利用人类视觉的一个特点，即对在某一阈值之下的变化感知不明显。

LSB算法比较简单，就是把载体的二进制低位替换为密文。  
优缺点：
- 人眼无法察觉图像变化
- 易受剪切和压缩的影响
- bmp或gif转jpg后，密文就会丢失
- 可嵌入的信息极多。例如，一幅图像是 800✖️600✖️3 的8位图，如果只嵌入最低位，可以嵌入800✖️600✖️3=1.44e6 bit 数据=180k byte

### LSB改进：Hide and Seek

上面提过，LSB可以嵌入极多的数据，那么我们可以放弃一定的嵌入容量，来换取隐蔽性。  

Hide and Seek 的思路就是随机选取一些像素点，在这些像素点上嵌入信息。

具体算法就不写了，几个整除。而且方法可以有很多。

### LSB替换

规则如下：
- 如果载体最后一位与密文一致，保持最后一位不变
- 如果不一致，随机+1或-1

然后真值表：
|原载体最后一位|密文|替换方法|替换后的载体最后一位
|--|--|--|--|
|1|1|1|1|
|1|0|±1|0|
|0|1|±1|1|
|0|0|0|0|


### 攻击LSB

chi2测试
- 假设：计算整体的奇偶比例，假设每个部分的奇偶比例等于整体的
- 如果隐写术顺序插入的，顺序检测到chi2的p值接近1，密文结束时，p值突然变成0。因此不但能检测出是否嵌入密文，还能检测出密文的长度。
- 如果隐写术不是顺序嵌入而是随机嵌入（Hide and Seek），Chi2 几乎失效。
- 因此，要对付 chi2测试，隐写算法必须控制密文信息量，如果密文信息量远小于载体容量，就很难用chi2测试发现隐写了。

RS


## 频域隐写技术
变换域技术包括：
- 离散余弦变换（discretecosinetransform，DCT）
- 离散小波变换（discretewavelettransform，DWT）
- 离散傅立叶变换（discretefouriertransform，DFT）
- Mellin傅立叶变换（mellinfouriertransform）


算法：
- JSteg是第一个有效公开的基于JPEG的隐写程序。
- F5所使用的嵌入操作与LSB匹配不同，它使用矩阵嵌入来保证嵌入的改变最小化。
- MBS1和MBS2使用LSB匹配，并保留DCT系数的模型。
- OutGuess和Steghide保留了一阶统计，Steghide改变系数对。除了OutGuess和F5，所有算法都以JPEG图像为输入，直接调制它们的DCT系数。

### JPEG压缩算法

原图的某个通道（所以可以处理RGB或YUV等），做以下处理：

![jpeg算法](/pictures_for_blog/digital_image_processing/jpeg.png)


以上来自书？？？

-------------

几种隐写术比较：

|方法|示例|埋入信息量|是否有损|鲁棒性|隐蔽性|
|--|--|--|--|--|--|
|隐写在频域上||少|有损|很强，抗各种攻击。|很强
|隐写在空域上||中|无损|弱|强|
|图种|`copy /b xx.jpg+xx.rar xx.jpg`|理论上无上限|无损|弱|几乎无，像素和文件大小不匹配、扫描内容都可以发现|


## 隐写术

来自S.Katzenbeisser：《信息隐藏技术 隐写术与数字水印》

### 历史回顾
